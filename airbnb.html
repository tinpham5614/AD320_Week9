<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=, initial-scale=1.0" />
    <link rel="stylesheet" href="airbnbstyle.css" />
    <title>AirBnB Search</title>
  </head>
  <body>
    <h1>AirBnB Search</h1>
    <form>
      <input id="property_type" type="text" placeholder="Property Type" />
      <input id="bedrooms" type="number" placeholder="Bedrooms" />
      <input id="beds" type="number" placeholder="Beds" />
    </form>
    <button id="button" onclick="fetchAirBnB()">Search</button>
    <div id="airbnb">
      <h4><ul id="airbnb-listing"></ul></h4>
    </div>

    <script>
      async function fetchAirBnB() {
        const property_type = document.getElementById("property_type").value;
        const bedrooms = document.getElementById("bedrooms").value;
        const bedrooms_number = parseInt(bedrooms, 10);
        const beds = document.getElementById("beds").value;
        const beds_number = parseInt(beds, 10);
        const query_string = `property_type=${property_type}&bedrooms=${bedrooms_number}&beds=${beds_number}`;
        const api_endpoint = `http://localhost:3000/findOne/?${query_string}`;
        //make a fetch request to my backend file
        const response = await fetch(api_endpoint);
        const data = await response.json();
        const airbnb = data.airbnb;
        console.log(airbnb);

        const ul_airbnb = document.getElementById("airbnb-listing");
        ul_airbnb.innerHTML = "";
        
        const li = document.createElement("li");
        li.innerHTML = `
        <p>Listing URL: ${airbnb.listing_url}</p>
        <p>Name: ${airbnb.name}</p>
        <p>Summary: ${airbnb.summary}</p>
        <p>Property Type: ${airbnb.property_type}</p>
        <p>Bedrooms: ${airbnb.bedrooms}</p>
        <p>Beds: ${airbnb.beds}</p>
        `;
        ul_airbnb.appendChild(li);
      }
    </script>
  </body>
</html>